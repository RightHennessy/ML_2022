# KNN : K-ìµœê·¼ì ‘ ì´ì›ƒ

## **K-Nearest Neighbors : K-ìµœê·¼ì ‘ì´ì›ƒ**

### ë¶„ë¥˜ì™€ íšŒê·€

ì§€ë„ í•™ìŠµì˜ ëŒ€í‘œì ì¸ ë¨¸ì‹  ëŸ¬ë‹ ë°©ë²•

âœ” ë¶„ë¥˜

ë¯¸ë¦¬ ì •ì˜ëœ, ê°€ëŠ¥ì„± ìˆëŠ” ì—¬ëŸ¬ í´ë˜ìŠ¤ ë ˆì´ë¸” ì¤‘ í•˜ë‚˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ê²ƒ.

â†’ ì´ì§„ ë¶„ë¥˜ (binary classification) : ë‘ê°œì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜

â†’ ë‹¤ì¤‘ ë¶„ë¥˜ (multiclass classification) : ì…‹ ì´ìƒì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜

âœ” íšŒê·€

ì—°ì†ì ì¸ ìˆ«ì ë˜ëŠ” ë¶€ë™ì†Œìˆ˜ì ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ê²ƒ.

### KNNì˜ ê°œë…

ì£¼ë³€ kê°œì˜ ìë£Œì˜ í´ë˜ìŠ¤ ì¤‘ ê°€ì¥ ë§ì€ í´ë˜ìŠ¤ë¡œ íŠ¹ì • ìë£Œë¥¼ ë¶„ë¥˜í•˜ëŠ” ë°©ì‹

Training-data ìì²´ê°€ ëª¨í˜•ì¼ ë¿ ì–´ë– í•œ ì¶”ì •ë°©ë²•ë„ ëª¨í˜•ë„ ì—†ìŒ

ì¦‰, ë°ì´í„°ì˜ ë¶„í¬ë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•œ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ì •í•˜ì§€ ì•ŠìŒ

ë§¤ìš° ê°„ë‹¨í•œ ë°©ë²•ì´ë‚˜ performanceëŠ” ë–¨ì–´ì§€ì§€ ì•ŠìŒ

âœ” ê²Œìœ¼ë¥¸í•™ìŠµ ë˜ëŠ” ì‚¬ë¡€ì¤‘ì‹¬í•™ìŠµ (instance-based learing)

ì•Œê³ ë¦¬ì¦˜ì€ í›ˆë ¨ë°ì´í„°ì—ì„œ íŒë³„í•¨ìˆ˜ (discriminative function)ë¥¼ í•™ìŠµí•˜ëŠ” ëŒ€ì‹  í›ˆë ¨ ë°ì´í„° ì…‹ì„ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ê¸° ë°©ë²•

âœ” ë°ì´í„°ì˜ ì°¨ì›ì´ ì¦ê°€ â†’ ì°¨ì›ì˜ ì €ì£¼ ë¬¸ì œ ë°œìƒ

KNNì€ ì°¨ì›ì´ ì¦ê°€í•  ìˆ˜ë¡ ì„±ëŠ¥ ì €í•˜ê°€ ì‹¬í•˜ë‹¤.

ë°ì´í„° ì°¨ì›ì´ ì¦ê°€í•  ìˆ˜ë¡ í•´ë‹¹ ê³µê°„ì˜ í¬ê¸°ê°€ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ì¦ê°€í•˜ì—¬ ë™ì¼í•œ ê°œìˆ˜ì˜ ë°ì´í„°ì˜ ë°€ë„ëŠ” ì°¨ì›ì´ ì¦ê°€í• ìˆ˜ë¡ ê¸‰ì†ë„ë¡œ í¬ë°•í•´ì§

### KNN ê±°ë¦¬ ê³„ì‚°ë²„

âœ” Minkowski (ë¯¼ì½”í”„ìŠ¤í‚¤) ê±°ë¦¬ë¥¼ ì´ìš©

m=1 : ë§¨í•˜íƒ„ ê±°ë¦¬

m=2 : ìœ í´ë¦¬ë””ì–¸ ê±°ë¦¬ (ì§ì„  ê±°ë¦¬)

![Untitled](KNN%20K-%E1%84%8E%E1%85%AC%E1%84%80%E1%85%B3%207bf1b/Untitled.png)

![Untitled](KNN%20K-%E1%84%8E%E1%85%AC%E1%84%80%E1%85%B3%207bf1b/Untitled%201.png)

### KNN ë¶„ë¥˜ (classification)

âœ” ê·¼ì ‘ì¹˜ kì˜ ê°œìˆ˜ì— ë”°ë¥¸ Group ë¶„ë¥˜ë²•

â†’ ë‹¤ìˆ˜ê²° ë°©ì‹ (Majority voting) : ì´ì›ƒ ë²”ì£¼ ë‚´ì—ì„œ ë¹ˆë„ê°€ ê°€ì¥ ë†’ì€ ë²”ì£¼ = ìƒˆ ë°ì´í„°ì˜ ë²”ì£¼

â†’ ê°€ì¤‘ í•© ë°©ì‹ (Weighted voting) : ê°€ê¹Œìš´ ì´ì›ƒì˜ ì •ë³´ì— ì¢€ ë” ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬

 

### KNN íšŒê·€ (regression)

âœ” y ì˜ˆì¸¡ì¹˜ ê³„ì‚° ë²•

kê°œì˜ ì •ë‹µ(y)ì˜ í‰ê· ì„ êµ¬í•œë‹¤.

â†’ ë‹¨ìˆœ íšŒê·€ : ê°€ê¹Œìš´ ì´ì›ƒë“¤ì˜ ë‹¨ìˆœí•œ í‰ê· 

â†’ ê°€ì¤‘ íšŒê·€ : ì´ì›ƒì´ ì–¼ë§ˆë‚˜ ê°€ê¹Œì´ì— ìˆëƒì— ë”°ë¼ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•´ í‰ê· ê³„ì‚°

### KNNì˜ í•˜ì´í¼ íŒŒë¼ë¯¸í„° K

âœ” íƒìƒ‰í•  ì´ì›ƒ ìˆ˜ : k

kê°€ ì‘ì„ ê²½ìš° ë°ì´í„°ì˜ ì§€ì—­ì  íŠ¹ì„±ì„ ì§€ë‚˜ì¹˜ê²Œ ë°˜ì˜ â†’ ê³¼ì ‘í•© (overfitting)

ë°˜ëŒ€ë¡œ ë§¤ìš° í´ ê²½ìš° â†’ ê³¼í•œ ì •ê·œí™” (underfitting)

### KNNì˜ ì¥ì ê³¼ ë‹¨ì 

âœ” ì¥ì 

í•™ìŠµ ë°ì´í„° ë‚´ì˜ ë…¸ì´ì¦ˆì˜ ì˜í–¥ì„ í¬ê²Œ ë°›ì§€ ì•ŠëŠ”ë‹¤.

í•™ìŠµë°ì´í„° ìˆ˜ê°€ ë§ë‹¤ë©´ ê½¤ íš¨ê³¼ì ì¸ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.

ë§ˆí• ë¼ë…¸ë¹„ìŠ¤ ê±°ë¦¬ì™€ ê°™ì´ ë°ì´í„°ì˜ ë¶„ì‚°ì„ ê³ ë ¤í•  ê²½ìš° ë§¤ìš° ê°•ê±´í•œ ë°©ë²•ë¡ 

: í‰ê· ê³¼ì˜ ê±°ë¦¬ê°€ í‘œì¤€ í¸ì°¨ì˜ ëª‡ë°°ì¸ì§€ ë‚˜íƒ€ë‚´ëŠ” ê°’, ì–¼ë§ˆë‚˜ ì´ìƒí•œ ê°’ì¸ì§€ë¥¼ ìˆ˜ì¹˜í™”í•˜ëŠ” ë°©ë²•

âœ” ë‹¨ì 

ìµœì  ì´ì›ƒì˜ ìˆ˜(k)ì™€ ì–´ë–¤ ê±°ë¦¬ ì²™ë„ê°€ ë¶„ì„ì— ì í•©í•œì§€ ë¶ˆë¶„ëª… 

â†’ ê° ë°ì´í„° íŠ¹ì„±ì— ë§ê²Œ ì—°êµ¬ìê°€ ì„ì˜ë¡œ ì„ ì •

best KëŠ” ë°ì´í„°ë§ˆë‹¤ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— íƒìš•ì  ë°©ì‹ (Grid Search)ìœ¼ë¡œ íƒìƒ‰ : ëª¨ë“  ê²½ìš°ë¥¼ ì‹œë„

ìƒˆë¡œìš´ ê´€ì¸¡ì¹˜ì™€ ê°ê°ì˜ í•™ìŠµ ë°ì´í„° ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ ì „ë¶€ ì¸¡ì • â†’ ê³„ì‚° ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¼

## ğŸ’»ì‹¤ìŠµí•´ë³´ê¸°

- KNN ë¶„ë¥˜ì™€ íšŒê·€ì˜ ì°¨ì´ì  ?
    
    ë¶„ë¥˜ëŠ” ë¼ë²¨ì´ ë¶™ì–´ êµ¬ë¶„ ê°€ëŠ¥ í•œê²ƒ. ì˜ˆë¥¼ ë“¤ì–´ ì‘ë¬¼ ë¶„ë¥˜ì²˜ëŸ¼. íšŒê·€ëŠ” ìë™ì°¨ ê°€ê²© ì˜ˆì¸¡ì²˜ëŸ¼ ë¼ë²¨ ë¶™ì—¬ êµ¬ë¶„ ë¶ˆê°€ëŠ¥í•œ ê²ƒ ~
    

### KNNì˜ í•˜ì´í¼ íŒŒë¼ë¯¸í„°

| parameter | info | default | kinds |
| --- | --- | --- | --- |
| â­ n_neighnors | ì´ì›ƒì˜ ê°¯ìˆ˜ | 5 | - |
| â­ weights | ê±°ë¦¬ì˜ ê°€ì¤‘ì¹˜ | uiform |  uniform  ê±°ë¦¬ì— ë”°ë¥¸ ê°€ì¤‘ì¹˜ ì—†ìŒ
 distance  ê°€ê¹Œìš´ ì´ì›ƒì¼ìˆ˜ë¡ ë†’ì€ ê°€ì¤‘ì¹˜
 callable  ì‚¬ìš©ìê°€ ì„ì˜ë¡œ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬ |
| algorithm | ê°€ê¹Œìš´ ì´ì›ƒì„ êµ¬í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ” ì•Œê³ ë¦¬ì¦˜ | auto |  auto   fit ë©”ì†Œë“œì—ì„œ ì „ë‹¬ëœ ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ
           ê°€ì¥ ì í•©í•œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©
 ball_tree  kd_treeì˜ ë¹„íš¨ìœ¨ì„± í•´ì†Œ ëŒ€ì‹  ë¹„ìŒˆ
                 ë§¤ìš° êµ¬ì¡°í™”/ë†’ì€ ì°¨ì› ë°ì´í„°ì— êµ¿
 kd_tree   ë¹„íš¨ìœ¨ì ì¸ brute í•´ì†Œ
                A-Bë©€ê³  B-Cê°€ ê°€ê¹ë‹¤ë©´ A-CëŠ” ë©€ë‹¤  
 brute   brute-force (=ì–µì§€ë¡œ)
             í° ìƒ˜í”Œì—ì„œ ë¹„íš¨ìœ¨ì  |
| leaf_size | ball_treeë‚˜ kd_treeì— 
ì „ë‹¬í•˜ëŠ” leafì˜ í¬ê¸° | 30 |  ì¶”ê°€ì„¤ëª…   íŠ¸ë¦¬ì—ì„œ ëª‡ ëŒ€ ëª‡ìœ¼ë¡œ ë»—ì–´ ë‚˜ê°ˆì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’ 
ë„ˆë¬´ ì‘ìœ¼ë©´ â†’ ê°€ì§€ ìˆ˜ê°€ ë§ì•„ì§
                         ë…¸ì´ì¦ˆê°€ ë¼ê¸° ì‰½ê³  ì†ë„ ëŠë¦¼
ë„ˆë¬´ í¬ë©´ â†’ ë„ˆë¬´ ëŒ€ì¶© ë¶„ë¥˜í•´ ì˜ˆì¸¡ ì„±ëŠ¥ ì €í•˜ |
| â­ p | ê±°ë¦¬ë¥¼ êµ¬í•  ë•Œ ì‚¬ìš©ë˜ëŠ”minkowskiì˜ ë§¤ê°œë³€ìˆ˜ | 2 |  l1 (p=1)   ë§¨í•˜íƒ„ ê±°ë¦¬
 l2 (p=2)   ìœ í´ë¦¬ë””ì–¸ ê±°ë¦¬ |
| metric | ë¯¸í„°ë²•, ê±°ë¦¬ê³„ì‚°ë²• | minkowski | ë‹¤ì–‘í•œ metricì´ ê¶ê¸ˆí•˜ë‹¤ë©´ â†’ ì°¸ê³ ìë£Œ |
| metric_params | metricì˜ ì¶”ê°€ í‚¤ì›Œë“œ | none | - |
| n_jobs | ê³„ì‚°ì— ì‚¬ìš©í•  CPU (core)ì˜ ê°¯ìˆ˜ë¥¼ ì§€ì • | none |  1   default(=none)ì¸ ê²½ìš° 1ê°œ ì‚¬ìš© â†’ ì˜ˆì™¸
 -1   ì‚¬ìš©ê°€ëŠ¥í•œ ëª¨ë“  core ì‚¬ìš© |

### KNNì˜ ë©”ì†Œë“œ

| methods | info | parameter |
| --- | --- | --- |
| â­ fit(X, y) | train ë°ì´í„°ì…‹ì— 
í•™ìŠµì‹œí‚¤ëŠ” ê³¼ì • |  X   training data 
 y   target values : ë‹µ ëª¨ìŒì§‘
â†’ ë°ì´í„°ì— ë‹µì„ ë§ì¶°ë³´ë©° ì¶”ì •ê¸° ìƒì„± |
| get_params([deep]) | ì¶”ì •ê¸°ì— ëŒ€í•œ ëª¨ìˆ˜ë¥¼ 
ì–»ì–´ì˜¤ëŠ” í•¨ìˆ˜ | default=True |
| kneighbors(X, n_neighbors, return_distance]) | Find the K-neighbors of a point.
Returns indices of and distances to the neighbors of each point. ( ë¨¸ë¼ëŠ”ê²¨.. =_= ) |  X   default=None (ìë™ ì „ë‹¬)
      The query point or points.
 n_neighbors   default=None (ìë™ ì „ë‹¬)
                        ê° ìƒ˜í”Œì— ìš”êµ¬ë˜ëŠ” n.. ê°œìˆ˜
 return_distance   default=True 
                            ê±°ë¦¬ë¥¼ ë°˜í™˜ë°›ì„ì§€ ì—¬ë¶€ |
| kneighbors_graph ([X, n_neighbors, mode]) | Compute the (weighted) graph of k-Neighbors for points in X. |  X   default=None (ìë™ ì „ë‹¬)
      The query point or points.
 n_neighbors   default=None (ìë™ ì „ë‹¬)
                        ê° ìƒ˜í”Œë“¤ì˜ neighbor ìˆ˜
 mode   default=connectivity
               : 0ê³¼ 1ë¡œ í‘œí˜„ëœ ì¸ì ‘í–‰ë ¬ ë°˜í™˜
              + distance : ê° í¬ì¸íŠ¸ë“¤ì˜ ê±°ë¦¬ |
| â­ predict(X) | train ë°ì´í„°ì˜ y ê°’ë“¤ì„ ì˜ˆì¸¡ |  X   test samples
 y   Xê°’ì— ëŒ€í•œ yê°’ë“¤ |
| predict_proba(X) | ê° ê°€ëŠ¥í•œ ê²°ê³¼ë“¤ì— ëŒ€í•œ 
í™•ë¥ ì„ ì˜ˆì¸¡ |  X   test samples |
| score(X, y[, sample_wight]) | ì£¼ì–´ì§„ í…ŒìŠ¤íŠ¸ ë°ì´í„° ë° ë ˆì´ë¸”ì— ëŒ€í•œ í‰ê·  ì •í™•ë„ ë„ì¶œ |  X   test samples
 y   Xê°’ì— ëŒ€í•œ ì‹¤ì œ y ì •ë‹µë“¤
 sample_weight   default=None |
| set_params(**params) | ì¶”ì •ê¸°ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì„¤ì • |  **params   ì¶”ì •ê¸°ì˜ ë§¤ê°œë³€ìˆ˜ |

```python
# í•™ìŠµ
model.fit(X_train, y_train)
# í•™ìŠµí‰ê°€ -> ë‚´ê°€ í’€ì—ˆë˜ ë¬¸ì œ ë‹¤ì‹œ í’€ê¸° // ë§ì¶˜ ë¹„ìœ¨
print(model.score(X_train, y_train))
# ì‹¤ì „í‰ê°€ // ë§ì¶˜ ë¹„ìœ¨ ì˜ˆ)0.987364223..
print(model.score(X_test, y_test))
# í•™ìŠµëœ ë¨¸ì‹ ì— ë‹µì´ ì—†ëŠ” ê°’ ë„£ì–´ ì˜ˆì¸¡ê°’ êµ¬í•˜ê¸°
x_test_pred = model.predict(X_test)
# ì˜ˆì¸¡ê°’ì´ ë§ì„ í™•ë¥  êµ¬í•˜ê¸° // ë°°ì—´ë¡œ ê²°ê³¼ê°’ ì•Œë ¤ì¤Œ
percent_x_pred = model.predict_proba(X_test)
```